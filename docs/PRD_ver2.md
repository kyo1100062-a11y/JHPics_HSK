# 지혜로운 Pictures (JH Pics) - 제품 요구사항 명세서 ver2

## 1. 프로젝트 개요

### 1.1 프로젝트명
지혜로운 Pictures (JH Pics)

### 1.2 프로젝트 목적
내부 행정업무의 사진 편집 및 출력 효율화를 위한 웹 기반 사진편집·출력 도구

다양한 업무 관련 사진을 쉽게 업로드 → 편집 → PDF/JPEG 출력할 수 있는 PC 중심의 웹 애플리케이션 개발

### 1.3 핵심 개발 방향
- 프런트엔드 단독으로 동작하는 구조
- 데이터 저장은 **사업리스트(LocalStorage)**만 사용
- 나머지 작업내역·사진은 저장 없음 (임시 메모리 사용)
- 직관적 사진 템플릿 편집기 제공
- A4 기반 고품질 PDF/JPEG 출력 기능 제공
- 로그인 없이 누구나 바로 사용 (내부 단독 사용)

## 2. 목표 사용자
- 내부 직원(단일 사용자)
- 로그인 불필요
- 여러 사용자가 동시에 사용할 필요 없음
- 개인 PC의 LocalStorage 기반 저장 사용

## 3. 전체 앱 구성

### 3.1 Home 화면
(1) 헤더: 로고, 메뉴 (Home, 사진편집, 사업리스트)

(2) 히어로 섹션(Hero Section) 문구
- 메인 문구(영문):
  - 1줄: "Manage your photos"
  - 2줄: "more efficiently"
- 서브 문구(한글):
  - "효율적인 사진 작업으로 행정 업무를 더욱 스마트하게"

(3) 템플릿 선택 섹션
- 제목: "템플릿 선택" (중앙 정렬)
- 서브 타이틀: "원하는 레이아웃과 방향을 선택하여 시작하세요" (중앙 정렬)

(4) 카드섹션
- 홈 화면의 카드 섹션은 총 4개의 기본 템플릿 카드로 구성: 4컷, 6컷, 커스텀, 커스텀2
- 각 카드 구성:
  - 상단: 큰 숫자/기호 (4컷: "4", 6컷: "6", 커스텀: "◳", 커스텀2: "⧉")
  - 중간: "Type 4컷" / "Type 6컷" / "Type 커스텀" / "커스텀 사진원본비율"
  - 하단: 세로형(Portrait) / 가로형(Landscape) 2개의 선택 버튼

(5) Footer
- "2025 • 지혜로운 Pictures • A picture is a silent witness • by Denbbura2"

### 3.2 사진편집 화면 (Editor)
템플릿 선택 후 편집 작업을 수행하는 메인 화면

### 3.3 사업리스트 화면
사업명 목록 관리 화면

## 4. 공통 UI 구조

### 4.1 헤더 (Header)
#### 4.1.1 로고
- 텍스트: "JH Pics"
- 색상: Accent Mint (#AEEAFF)
- 글로우 효과 적용

#### 4.1.2 메인 메뉴
- 위치: 헤더 우측 상단
- 메뉴 항목: Home, 사진편집, 사업리스트
- 현재 활성 메뉴는 Neoblue 배경으로 표시

### 4.2 Footer
"2025 • 지혜로운 Pictures • A picture is a silent witness • by Denbbura2"

## 5. 템플릿 & 편집기 기능

### 5.1 템플릿 종류 (총 10종)
⬆ 세로( Portrait )
- twoCut-portrait (1×2)
- fourCut-portrait (2×2)
- sixCut-portrait (2×3)
- custom-portrait
- custom2-portrait (커스텀2 – 원본비율 세로형)

↔ 가로( Landscape )
- twoCut-landscape (2×1)
- fourCut-landscape (2×2 동일)
- sixCut-landscape (3×2)
- custom-landscape
- custom2-landscape (커스텀2 – 원본비율 가로형)

## 6. 사진 편집 화면 (Editor)

### 6.1 전체 구조

#### 6.1.0 화면 레이아웃 구성
- 상단 입력 영역: 제목, 사업명, 보조사업자, 담당자 입력 필드 (가로 배치)
- 페이지 네비게이션: 상단 입력 영역 바로 아래, A4Canvas 위쪽에 위치
  - 현재 페이지 표시: "페이지 N" 버튼
  - 페이지 추가 버튼
  - 현재 페이지 삭제 버튼 (2페이지 이상일 때만 활성화)
- 메인 캔버스 영역: A4Canvas 표시 영역 (좌측 넓은 영역)
- 우측 사이드바:
  - 제목 스타일 옵션 영역 (출력 옵션 박스 위)
  - 출력 옵션 영역
  - 작업 관리 영역 (현재화면 초기화 버튼)

#### 6.1.1 A4Canvas 구조
(1) A4 전체 크기: 210mm × 297mm

(2) 캔버스 마진(Canvas Margin): A4 경계와 OuterFrame 사이에 상·하·좌·우 각각 20mm

(3) OuterFrame (외곽 프레임): 2px, solid black
- 캔버스 마진(20mm) 안쪽에 배치
- OuterFrame 내부에는 8mm 내부 여백(padding) 존재
- 캔버스 배경: 흰색

(4) OuterFrame 내부 영역:
- Metadata Area (메타데이터 영역)
- Image Area (이미지 슬롯 영역)

OuterFrame → Metadata → ImageArea 순으로 상단에서 하단으로 배치

#### 6.1.2 Metadata Area (메타데이터 영역)
- 전체 A4Canvas 상단에 배치
- 메타데이터 영역과 이미지 영역의 간격은 6mm로 고정
- 모든 메타데이터 텍스트 색상: 매우 짙은 회색 (#333333)

▷ 구성: 3줄 구성(최대)
- 1줄: 제목 + [사업명 : 사업명값] 형식으로 표시 (한 줄에 표기)
- 2줄: 보조사업자 : 보조사업자값 (수기입력)
- 3줄: 담당자: 담당자값 (수기입력)
- "사업명", "보조사업자"와 콜론 사이에는 공백 한 칸 포함

▷ 줄 표현 규칙
- 보조사업자/담당자 입력이 비어있으면 해당 줄은 제거
- 즉, 메타데이터 영역 전체는 동적(가변형)

▷ 제목 스타일 옵션
- 제목 줄(1줄)에만 스타일 옵션 적용
- 정렬: 왼쪽/가운데/오른쪽 (아이콘 버튼 3개)
- 글꼴: 총 20개 폰트 선택 가능 (Select 박스)
  - 웹폰트 7개: SUIT, Inter, Noto Sans KR, Pretendard, Nanum Gothic, Nanum Myeongjo, IBM Plex Sans KR
  - Windows 기본 글꼴 13개: Malgun Gothic, New Mingjo, Gulim, Human Myeongjo, Gungsuh, Dotum, HY MyeongJo, HY Headline M, Segoe UI, Arial, Tahoma, Courier New, Times New Roman
  - 각 선택지는 해당 font-family로 미리보기 스타일 적용
  - 폰트 fallback 처리: 선택된 폰트 + 'Malgun Gothic' + sans-serif
- 글꼴 크기: 8~72px (Number input, 기본값: 19px)
- 진하게: Checkbox (기본값: false)
- 보조사업자/담당자 줄(2줄, 3줄)은 항상 왼쪽 정렬로 고정
- 각 페이지별로 독립적으로 제목 스타일 관리
- PDF/JPEG 출력 시에도 동일한 스타일 적용
- 웹폰트는 CDN 방식으로 로드 (index.html)
- html2canvas의 onclone 단계에서 폰트 스타일 정확히 복사하여 웹폰트 깨짐 방지

#### 6.1.3 Image Area (이미지 슬롯 영역)
- 이미지 영역 상단: 메타데이터 영역 하단과 6mm 간격
- 이미지 영역 좌/우/하단: OuterFrame 내부 여백과 동일하게 각 8mm
- 슬롯 간 간격: 2mm

### 6.2 페이지 관리

#### 6.2.1 페이지 추가
- 버튼 클릭 시 A4 페이지 추가
- 동시 생성 가능한 페이지 수: 최대 10페이지
- 새 페이지 추가 시: 직전 페이지의 메타데이터 값을 복사해서 초기값으로 사용
- 각 페이지의 메타데이터는 독립적으로 수정 가능
- 새 페이지에는 템플릿에 맞는 슬롯이 자동으로 생성됨

#### 6.2.2 페이지 삭제
- 2페이지 이상일 때만 삭제 가능
- 최소 1페이지는 유지해야 함

#### 6.2.3 페이지 네비게이션
- 현재 페이지는 Neoblue 배경으로 표시
- 페이지 버튼 클릭 시 해당 페이지로 이동
- 각 페이지는 PDF/JPEG 출력 시 순서대로 반영

### 6.3 기본 템플릿 슬롯 규칙 (2·4·6컷)
템플릿 2·4·6은 고정 슬롯 수를 가진다.

슬롯은 이미지 영역 내부에서 자동 정렬되며, 슬롯 간 겹침 없음, 메타데이터 영역과 겹침 없음, OuterFrame과 겹침 없음을 기본 규칙으로 한다.

슬롯 크기는 이미지 영역 내에서 가능한 범위에서 최대 크기로 자동 조정된다.

방향(세로형/가로형)에 따라 슬롯 배열이 변경된다:
- 세로형(포트레이트) → 2컷(1×2), 4컷(2×2), 6컷(2×3)
- 가로형(랜드스케이프) → 2컷(2×1), 4컷(2×2 동일), 6컷(3×2)

▷ 비율유지 버튼 제거 규칙
- **4컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음
- **6컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음
- 2컷 템플릿은 기존 동작 유지 (비율유지 버튼 표시)

### 6.4 현재화면 초기화 기능 (신규)
#### 6.4.1 기능 설명
- 모든 작업 내용을 삭제하고 처음부터 다시 작업하고 싶을 때 사용
- 출력 옵션 박스 아래 "작업 관리" 영역에 "현재화면 초기화" 버튼 제공

#### 6.4.2 동작 규칙
- 초기화 전 확인 대화상자 표시
- 확인 시:
  - 모든 페이지의 이미지 blob URL 해제 (메모리 누수 방지)
  - 템플릿은 유지하면서 새로운 빈 페이지 하나만 생성
  - 모든 편집 내용 삭제
- 취소 시 아무 작업도 하지 않음

### 6.5 Custom 템플릿 기능
custom-portrait / custom-landscape 선택 시만 활성화

기능 요구사항:
- "슬롯 추가" 버튼: 메타데이터 영역 바로 아래, 이미지 영역의 우측 상단에 고정 배치
- 슬롯 최대 개수: 16개
- 슬롯 최소 크기: 300px × 300px 이상
- 슬롯 간 겹침 금지

▷ 비율유지 버튼 제거 규칙
- **커스텀1 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음

#### 6.5.1 custom-portrait 슬롯 배치 규칙
슬롯 개수에 따른 행/열 배치 규칙:
- 슬롯 1개: 1행
- 슬롯 2개: 1열 × 2행 (2행)
- 슬롯 3~4개: 2행
- 슬롯 5~9개: 3행
- 슬롯 10~12개: 4행
- 슬롯 13~16개: 5행

▷ 텍스트 영역 보호 규칙
- 세로형 4행(슬롯 10-12개) 및 5행(슬롯 13-15개)에서 텍스트 영역이 잘리지 않도록 슬롯 최소 높이 130px 보장
- 텍스트 영역(21px) + 이미지 최소 공간(100px)을 고려한 높이 보정 적용
- 편집 화면과 출력(PDF/JPEG) 모두에서 텍스트 내용이 정상적으로 표시됨
- 다른 행 수(1-3행)에서는 기존 동작 유지

#### 6.5.2 custom-landscape 슬롯 배치 규칙
슬롯 개수에 따른 행/열 배치 규칙:
- 기본 그리드 레이아웃 (4열 × 4행 최대)
- 슬롯 개수에 따라 자동으로 그리드 크기 조정

▷ 텍스트 영역 보호 규칙
- 가로형 3행(슬롯 7-12개) 및 4행(슬롯 13-16개)에서 텍스트 영역이 잘리지 않도록 슬롯 최소 높이 130px 보장
- 텍스트 영역(21px) + 이미지 최소 공간(100px)을 고려한 높이 보정 적용
- 편집 화면과 출력(PDF/JPEG) 모두에서 텍스트 내용이 정상적으로 표시됨
- 다른 행 수(1-2행)에서는 기존 동작 유지

### 6.6 Custom2 템플릿 기능 (커스텀2 – 원본비율)
custom2-portrait / custom2-landscape 선택 시만 활성화

#### 6.6.1 기본 기능
- Custom 템플릿과 동일한 UI/슬롯 구조/동작 방식 유지
- 페이지 추가/삭제, 슬롯 추가/삭제, 이미지 업로드/드래그, 텍스트 입력 등 모든 공통 기능은 기존 커스텀과 동일
- 단, 이미지 처리 방식만 다름

#### 6.6.2 이미지 처리 규칙
- **원본비율 cover 모드 강제 적용**
  - 슬롯에 이미지를 넣을 때, 또는 기존 이미지를 교체할 때 항상 `object-fit: cover` 형태로 꽉 채워 넣음
  - 원본 비율 유지, 슬롯을 완전히 채움 (잘리는 부분 허용)
  - CSS `object-fit: cover` 사용 (JS transform 기반 scale/translate cover 구현 아님)
  - 이미지 업로드 순간부터 cover 모드가 기본값으로 자동 적용
- **비율유지 버튼 없음**
  - 이 템플릿에서는 "비율유지" 버튼(cover/fill 토글)은 UI/기능 둘 다 존재하지 않음
  - 어떤 경우에도 fill 기반 계산으로 되돌아가지 않음

#### 6.6.3 이미지 확정 기능
- **데이터 구조**
  - `ImageSlot` 인터페이스에 `croppedImageUrl?: string` 필드 추가 (Custom2에서 자동 크롭된 이미지)
  - `ImageSlot` 인터페이스에 `isConfirmed?: boolean` 필드 추가 ("이미지 확정" 버튼을 통해 확정되었는지)
  - Custom2 템플릿 구분을 위한 `isCustom2Template()` 헬퍼 함수 제공
- **이미지 확정 버튼**
  - 출력 옵션 영역에 "이미지 확정" 버튼 제공 (Custom2 템플릿에서만 표시)
  - 버튼 클릭 시 모든 슬롯의 이미지를 자동으로 크롭하여 `croppedImageUrl` 생성
  - 크롭 로직:
    - 현재 화면에 표시된 이미지의 실제 크기(slotWidth, slotHeight)를 기준으로 계산
    - 원본 이미지의 naturalWidth/naturalHeight를 사용하여 cover 모드 기준으로 크롭
    - 현재 편집 상태(scale, rotation)를 반영하여 크롭됨
    - exportScale 3배율로 고화질 크롭 수행
    - Canvas API를 사용하여 오프스크린에서 크롭 처리
  - 각 슬롯에 `isConfirmed: true` 및 `croppedImageUrl` 저장
  - 확정 완료 시 "이미지 확정이 완료되었습니다." 토스트 메시지 표시
- **렌더링 우선순위**
  - Custom2 템플릿의 `ImageSlot` 컴포넌트에서 `croppedImageUrl ?? imageUrl` 우선순위로 이미지 표시
  - "이미지 확정" 전에는 `imageUrl` 사용 (기존 cover 미리보기)
  - "이미지 확정" 후에는 `croppedImageUrl` 사용 (실제 크롭된 비트맵)
  - 크롭된 이미지는 이미 편집 상태가 적용된 상태이므로 transform(scale, rotation) 적용하지 않음
- **출력 전 필수 검사**
  - Custom2 템플릿에서 PDF/JPEG 출력 시도 시, 이미지가 있는 슬롯 중 확정되지 않은 슬롯이 있으면 경고 메시지 표시
  - 검사 조건: `hasImage && (!isConfirmed || !croppedImageUrl)`
  - "커스텀2 템플릿에서는 출력 전에 반드시 '이미지 확정' 버튼을 눌러주세요." 메시지와 함께 출력 중단
  - 모든 슬롯이 확정된 경우(`isConfirmed: true` 및 `croppedImageUrl` 존재)에만 출력 진행
  - 출력 시 `croppedImageUrl`이 있으면 해당 이미지를 사용하여 출력

#### 6.6.4 슬롯 배치 규칙
- custom2-portrait: custom-portrait와 동일한 슬롯 배치 규칙 적용
- custom2-landscape: custom-landscape와 동일한 슬롯 배치 규칙 적용

## 7. 메타데이터(Core Metadata)

각 페이지에 고정적으로 표시되는 입력 영역

### 7.0 입력 필드 레이아웃
- 상단 입력 영역에 가로로 배치: 제목, 사업명, 보조사업자, 담당자
- 각 입력 필드는 적절한 간격으로 배치

### 7.1 제목
- 기본값: "현장확인 사진"
- 사용자 자유 입력
- 제목 스타일 옵션: 정렬(왼쪽/가운데/오른쪽), 글꼴, 글꼴 크기, 진하게 설정 가능

### 7.2 사업명
- 사업리스트(LocalStorage 저장) 드롭다운 연동 + 직접 입력 가능

### 7.3 보조사업자
- 수기 입력

### 7.4 담당자
- 수기 입력

## 8. 이미지 업로드 & 편집 기능

### 8.1 이미지 처리 규격
- 지원 이미지 포맷: JPG, PNG, WEBP
- 최대 파일 크기: 최대 15MB (권장 3~8MB)
- 최대 해상도: 최대 6000px × 6000px
- 동시 업로드 가능 이미지 개수: 템플릿 슬롯 개수에 한함 (custom 템플릿은 최대 16개)

### 8.2 사진 업로드 방식
- 슬롯 클릭 → 이미지 첨부
- 파일 선택(Explorer)
- Drag & Drop (드래그 시 시각적 피드백 표시)
- 원본 이미지가 슬롯 크기에 맞게 자동 조정

#### 8.2.1 이미지 표시 모드
- 기본값: 
  - 이미지 업로드 시 기본적으로 적용됨
  - 이미지가 슬롯 크기에 맞춰 늘어나거나 줄어들어 전체 이미지가 표시됨
  - 이미지의 가로·세로 비율이 왜곡될 수 있으나, 이미지 누락 없이 전체가 표시됨
- 선택 옵션: "비율 유지 (일부 잘림 허용)" - object-fit: cover
  - 업로드된 이미지에 마우스를 올리면 "비율유지" 버튼이 표시됨
  - "비율유지" 버튼 클릭 시 해당 슬롯의 이미지가 "비율 유지" 모드로 전환됨
  - 이미지의 원본 비율을 유지하면서 슬롯을 꽉 채움
  - 이미지의 일부가 잘릴 수 있으나, 왜곡 없이 표시됨
- 각 슬롯별로 독립적으로 표시 모드를 설정할 수 있음
- 새 이미지를 업로드하면 기본값("전체 표시")으로 리셋됨
- **템플릿별 비율유지 버튼 표시 규칙**
  - **4컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음
  - **6컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음
  - **커스텀1 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음
  - **Custom2 템플릿 (가로형, 세로형)**: "비율유지" 버튼이 표시되지 않음 (항상 `object-fit: cover` 모드로 강제 적용)
  - **2컷 템플릿**: "비율유지" 버튼이 표시됨 (기존 동작 유지)

#### 8.2.2 빈 슬롯 디자인
- 점선 테두리 (dashed border), 점선색상: 매우 짙은 회색
- 중앙에 큰 "+" 아이콘
- "+" 아이콘 하단에 "사진 추가 또는 드래그하여 업로드" 텍스트
- 배경: 연한 회색 또는 흰색

#### 8.2.3 이미지 업로드 후 슬롯 디자인
- 이미지가 업로드된 슬롯은 검정색 작은 점선 테두리(1px dashed #000000)로 표시
- 슬롯 크기는 고정되어 있으며, 이미지는 슬롯 크기에 맞춰 표시

### 8.3 이미지 슬롯 내 인터랙션
이미지에 마우스를 올리면 다음 버튼 표시됨:
- 편집
- 삭제
- 내용추가

### 8.4 버튼별 상세 기능
#### ① 편집(Edit)
모달 창에서 아래 기능 제공:
- 확대/축소: 범위 50% ~ 200%
- 회전: 90° 단위 회전
- 미리보기: 중앙 정렬, 슬롯 비율 유지

▷ 편집 모달 적용 규칙
- 편집 모달에는 "적용" 버튼이 존재하며, 확대/축소/회전 후 "적용"을 누르면 해당 편집 상태가 즉시 슬롯 이미지에 반영됨
- "취소" 시 변경 내용은 저장되지 않음
- 출력(PDF/JPEG)은 적용된 최종 이미지 상태를 기반으로 캡처함
- 회전된 이미지는 출력(PDF/JPEG) 시 편집 모달에서 적용된 회전 상태를 그대로 반영함

#### ② 삭제(Delete)
- 슬롯 내의 이미지 제거
- 이미지 삭제 시 blob URL 자동 해제 (메모리 누수 방지)
- 이미지 교체 시 이전 이미지의 blob URL도 자동 해제

#### ③ 내용추가(Add Description)
- "내용추가" 버튼 클릭 시 별도 모달 창을 생성하지 않고, 슬롯 내부 하단에 직접 텍스트 입력란이 생성됨
- 사진별 개별 설명 가능
- 텍스트 입력란은 실시간으로 저장됨 (100ms debounce 적용)

▷ 텍스트 입력란 동작 규칙
- 슬롯 크기는 절대 고정되어 있어야 함
- 이미지가 업로드된 슬롯에서 "내용추가" 버튼을 클릭하면, 슬롯 내부 하단에 텍스트 입력란(textarea)이 생성됨
- 텍스트 입력란이 생성되면 이미지의 높이가 일부 줄어들고, 줄어든 만큼의 공간에 입력란이 배치됨
- 입력란은 슬롯 내부 하단에 고정되어 있으며, 이미지와 겹치지 않음
- 텍스트가 없을 때(description == undefined 또는 '')는 텍스트 영역이 화면에 보이지 않음 (height: 0, visibility: hidden, pointer-events: none)
- "내용추가" 버튼 클릭 시 텍스트 영역이 즉시 표시되고 자동 포커스됨 (height: auto, visibility: visible, pointer-events: auto)
- blur 시 내용이 있으면 유지, 공백이면 텍스트 영역이 다시 숨김 처리됨

▷ 텍스트 입력 반응성 최적화
- 로컬 state를 사용하여 타이핑 시 즉시 화면에 반영됨 (UI 반응성 향상)
- 부모 컴포넌트로는 100ms debounce로 전달되어 저장 최적화
- 일반적인 텍스트 입력과 동일한 자연스러운 입력 경험 제공

▷ 텍스트 스타일
- 폰트 스타일: 기본 Sans-serif
- 위치: 슬롯 내부 하단에 포함되도록 명시 (이미지 바로 하단 고정)
- 패딩: 0
- 정렬: 위쪽 정렬 (items-start)

일반 템플릿 (2컷, 4컷, 6컷):
- 폰트 크기: 13px (고정)
- 줄 간격: 13px (고정)
- 높이: 30px (고정)
- 최소/최대 높이: 30px (고정)
- 컨테이너 높이: 32px (고정, border 포함)
- 컨테이너 최소/최대 높이: 32px (고정)
- 줄바꿈: 한 줄 강제 (nowrap)

커스텀 템플릿 (custom-portrait/landscape):
- 폰트 크기: 11px (고정)
- 줄 간격: 13px (고정)
- 높이: 20px (고정)
- 최소/최대 높이: 20px (고정)
- 컨테이너 높이: 21px (고정, border 포함)
- 컨테이너 최소/최대 높이: 21px (고정)
- 줄바꿈: 한 줄 강제 (nowrap)

## 9. 출력 기능 (PDF / JPEG Export)

### 9.1 A4 캔버스 규격
A4 실크기(mm): 210 × 297mm

일반 출력:
- A4 픽셀: 2480 × 3508px
- 해상도: 약 300dpi
- JPEG 품질: 0.6 ~ 0.7
- html2canvas scale: 2.5

고화질 출력:
- A4 픽셀: 3508 × 4961px
- 해상도: 425dpi
- JPEG 품질: 0.85 ~ 0.9
- html2canvas scale: 3.5

### 9.2 출력 옵션

#### 9.2.1 우측 사이드바 구성
제목 스타일 옵션 영역 (출력 옵션 박스 위):
- 정렬 방식: 왼쪽/가운데/오른쪽 아이콘 버튼 3개
- 글꼴 선택: Select 박스 (총 20개 폰트)
  - 웹폰트 7개: SUIT, Inter, Noto Sans KR, Pretendard, Nanum Gothic, Nanum Myeongjo, IBM Plex Sans KR
  - Windows 기본 글꼴 13개: Malgun Gothic, New Mingjo, Gulim, Human Myeongjo, Gungsuh, Dotum, HY MyeongJo, HY Headline M, Segoe UI, Arial, Tahoma, Courier New, Times New Roman
  - 각 선택지는 해당 font-family로 미리보기 스타일 적용
- 글꼴 크기: Number input (8~72px)
- 진하게: Checkbox

출력 옵션 영역:
- **Custom2 전용 이미지 확정 버튼** (Custom2 템플릿에서만 표시)
  - "이미지 확정" 버튼: 모든 슬롯의 이미지를 자동 크롭하여 확정
  - 버튼 클릭 시 각 슬롯의 이미지를 cover 모드 기준으로 크롭하여 `croppedImageUrl` 생성
  - 현재 편집 상태(scale, rotation)를 반영하여 크롭됨
  - 확정 완료 시 "이미지 확정이 완료되었습니다." 토스트 메시지 표시
  - 버튼 스타일: Green 배경 (#22c55e), White 텍스트
- PDF 내보내기 버튼
- JPEG 내보내기 버튼
- 고화질 출력 체크박스

고화질 출력 옵션 (체크박스)
- 일반: 약 3MB 이하
- 고화질: 최대 10MB 이하로 자동 조정

### 9.3 출력 규칙

#### 9.3.0 Custom2 템플릿 출력 전 필수 검사
- **검사 시점**: PDF/JPEG 내보내기 버튼 클릭 시, `exportToPDF` / `exportToJPEG` 호출 전에 검사 수행
- **검사 로직**:
  - 모든 페이지를 순회하며 Custom2 템플릿인지 확인 (`isCustom2Template()` 함수 사용)
  - Custom2 템플릿인 경우, 각 슬롯에 대해 다음 조건 확인:
    - `hasImage`: `!!slot.imageUrl || !!slot.imageFile` (이미지가 있는지)
    - `notConfirmed`: `!slot.isConfirmed || !slot.croppedImageUrl` (확정되지 않았는지)
    - 두 조건을 모두 만족하는 슬롯이 하나라도 있으면 검사 실패
- **검사 실패 시**:
  - `alert()` 함수로 경고 메시지 표시: "커스텀2 템플릿에서는 출력 전에 반드시 '이미지 확정' 버튼을 눌러주세요."
  - 출력 프로세스 즉시 중단 (`return` 처리)
  - `isExporting` 상태 변경 없음 (버튼 비활성화 상태 유지)
- **검사 통과 시**:
  - 모든 슬롯이 확정된 경우(`isConfirmed: true` 및 `croppedImageUrl` 존재)에만 출력 진행
  - 출력 시 `croppedImageUrl`이 있으면 해당 이미지를 사용하여 출력
  - 기존 출력 로직 그대로 진행

여러 페이지(2페이지 이상) 작업 시:
- PDF는 한 파일로 통합
- 페이지 누락없이 순서대로
- A4 비율 유지

JPEG 출력 시:
- JPEG는 페이지별로 개별 파일 생성
- 파일명 규칙: "제목"("사업명")_"보조사업자"_페이지N.jpg 형태로 저장됨
- 각 페이지의 메타데이터를 사용하여 파일명 생성
- 예: "현장확인사진(2025년4-H과제활동지원사업)_홍길동_페이지1.jpg"

#### 9.3.0 다중 페이지 출력 구현 방식 (절충안 3번)
▷ 구현 방식
- 출력 시 모든 페이지를 임시 DOM 컨테이너에 동시에 렌더링
- 각 페이지는 React Root를 사용하여 독립적으로 렌더링
- 모든 페이지가 완전히 렌더링될 때까지 대기
- 각 페이지의 이미지 로드를 명시적으로 대기
- 브라우저 렌더링 완료를 위해 requestAnimationFrame 사용

▷ 페이지 순서 보장 메커니즘
- 각 페이지는 순차적으로 html2canvas로 캡처됨
- 캡처 순서는 페이지 인덱스(1, 2, 3, ...) 순서를 보장함
- 모든 페이지가 DOM에 안정적으로 존재한 상태에서 순차적으로 캡처하여 안정성 확보

▷ 캡처 상태 반영 및 안정성 보장
- 다중 페이지 캡처 시 각 페이지는 편집된 최종 슬롯 상태(설명 텍스트 포함)를 기반으로 순서대로 캡처됨
- 페이지 간 이미지·텍스트의 흐림/누락을 방지하기 위해 각 페이지는 동일한 A4Canvas 상태와 레이아웃 규칙을 공유함
- 임시 DOM 컨테이너는 화면 밖에 위치하고 opacity: 0으로 설정하여 사용자에게 보이지 않음

▷ 에러 처리 및 페이지 누락 방지
- 특정 페이지 캡처 실패 시, 해당 페이지를 건너뛰고 다음 페이지를 계속 처리함
- 모든 페이지 처리 완료 후, 실패한 페이지가 있으면 사용자에게 알림을 표시함
- 실패한 페이지 목록을 로그에 기록함

▷ 메모리 관리
- 출력 완료 후 임시 DOM 컨테이너와 모든 React Root를 정리
- html2canvas로 생성된 캔버스는 사용 후 메모리 해제 (width: 0, height: 0 설정)
- 출력 과정에서 생성된 모든 리소스가 안전하게 정리됨

▷ 아웃프레임 크기 일관성 보장
- 각 페이지를 캡처하기 전에 A4Canvas와 OuterFrame의 크기를 동일하게 강제 설정함
- 모든 페이지에서 아웃프레임 크기는 210mm × 297mm 기준으로 일관되게 유지됨
- 캔버스 마진(상·하·좌·우 각 20mm)과 OuterFrame 내부 여백(8mm)은 모든 페이지에서 동일하게 적용됨
- 이미지 비율이 달라도(가로가 매우 긴 사진, 세로가 매우 긴 사진 등) 아웃프레임 및 캔버스 마진 크기는 변경되지 않음
- 각 페이지의 이미지가 서로 다른 비율을 가져도 출력 시 모든 페이지의 아웃프레임 크기는 동일하게 유지됨

#### 9.3.1 출력 시 UI 요소 제거 규칙
PDF/JPEG 출력 시 다음 UI 요소들은 모두 제거하여 출력되지 않도록 함:
- 페이지 네비게이션 UI (페이지 N 버튼, 이전/다음 페이지 버튼 등)
- 슬롯 추가 버튼
- 편집/삭제/내용추가 버튼
- 비율유지 버튼
- 슬롯 삭제 버튼 (커스텀 템플릿의 × 버튼)
- 크기 조절 핸들바
- 그 외 편집 전용 표시 요소

**모든 템플릿(2/4/6컷 + 커스텀)에 공통 적용됨**

▷ 구현 방식
- html2canvas가 캡처하기 전에 CSS로 `display: none` 처리하여 화면에서 숨김
- 편집 UI 요소(버튼, 오버레이 등)를 자동으로 감지하여 출력 전에 숨김 처리
- 캡처 완료 후 UI 요소를 원래 상태로 복원
- 출력 시에는 A4Canvas 내부 요소(메타데이터와 이미지 슬롯: 업로드된 이미지 및 해당 설명 텍스트)만 포함됨

#### 9.3.2 빈 슬롯 출력 처리
- 출력 시 빈 슬롯도 공간을 유지하며 출력됨
- 빈 슬롯은 하얀 배경만 표시됨 (점선 테두리 및 + 아이콘 제거)
- 작업 화면과 동일한 레이아웃으로 출력됨
- 이미지가 있는 슬롯은 확대되지 않고 원래 크기 유지

### 9.4 파일 저장 기능
#### 9.4.1 기능 설명
- 출력 버튼(PDF 내보내기 또는 JPEG 내보내기) 클릭 시 "다른 이름으로 저장하기" 대화상자 표시
- File System Access API의 `showSaveFilePicker()`를 사용하여 파일명 직접 지정 가능
- Windows/MacOS의 표준 저장 대화상자와 동일한 사용자 경험 제공

#### 9.4.2 동작 규칙
- 출력 버튼 클릭 시 파일명 입력 대화상자 표시
- 기본 파일명 자동 입력: `${제목}_${사업명}_${보조사업자}.pdf` 또는 `.jpg` 형식
- 사용자가 파일명을 자유롭게 수정 가능
- 파일 확장자 선택: PDF(.pdf) 또는 JPEG(.jpg, .jpeg)
- 저장 완료 시 "저장되었습니다" 메시지 표시
- 사용자가 저장을 취소하면 작업 중단

#### 9.4.3 파일 저장 방식
- PDF: 단일 파일로 저장, 파일명 한 번만 입력
- JPEG: 각 페이지마다 파일명 입력 (다중 페이지인 경우)
- Blob 형식으로 변환하여 저장
- Content-Type 자동 설정 (application/pdf 또는 image/jpeg)

#### 9.4.4 브라우저 지원
- Chrome (최신 버전) - 완전 지원
- Edge (최신 버전) - 완전 지원
- Firefox/Safari는 제한적 지원 (기존 다운로드 방식으로 자동 대체)

#### 9.4.5 동작 검증 로그
- showSaveFilePicker 호출 여부
- 선택된 파일명
- 파일 저장 성공 여부
- Blob 크기 및 형식(PDF/JPEG) 정보

### 9.5 고화질 옵션 상세
파일 크기 조정:
- 최대 10MB 넘지 않도록 JPEG 품질 자동 조정

### 9.6 PDF 출력 상세
PDF 버전: 1.3 이상

PDF 메타데이터 포함:
- 제목, 사업명, 보조사업자, 담당자
  - 첫째줄: 제목 + (사업명)
  - 둘째줄: 보조사업자
  - 셋째줄: 담당자
- Page count

▷ 가로형/세로형 템플릿 출력 처리
- 가로형 템플릿(landscape) 출력 시:
  - PDF orientation: landscape (가로 방향)
  - A4 크기: 297mm × 210mm (가로형 기준)
  - 캔버스 비율을 유지하면서 A4 크기에 맞춰 이미지 크기 조정
- 세로형 템플릿(portrait) 출력 시:
  - PDF orientation: portrait (세로 방향)
  - A4 크기: 210mm × 297mm (세로형 기준)
  - 캔버스 비율을 유지하면서 A4 크기에 맞춰 이미지 크기 조정
- 사진편집 화면과 동일한 레이아웃으로 출력됨 (페이지 마진 20mm 유지)

▷ 출력 파일명 규칙
- 출력 시 파일명은 "제목"("사업명")_"보조사업자" 형태로 저장됨
- 예: "현장확인사진(2025년4-H과제활동지원사업)_홍길동.pdf"
- 파일명에 사용할 수 없는 특수문자는 언더스코어(_) 또는 하이픈(-)으로 대체됨

### 9.7 페이지 번호 규칙
페이지 1개일 경우 → 번호 없음

2페이지 이상일 경우:
- 각 페이지에 "N / 총페이지수" 형식으로 표시
- 예) 1 / 3, 2 / 3, 3 / 3

표시 위치: OuterFrame 하단 중앙

스타일:
- 폰트 크기: 10px
- 색상: Gray (#9CA3AF)

## 10. 사업리스트 기능 (LocalStorage 기반)

### 10.1 기능
- 사업명 목록 조회
- 사업 추가 (+ 버튼 → 모달 입력)
- 사업명 수정
- 사업명 삭제
- 사진편집 화면의 드롭다운에서 선택 가능
- LocalStorage에 자동 영구 저장

### 10.2 UI 요구사항

#### 10.2.1 페이지 레이아웃
- 페이지 제목: "사업 리스트" (좌측 상단, 큰 화이트 텍스트)
- 추가 버튼: "+ 사업 추가" (우측 상단, 라이트 블루 배경의 직사각형 버튼)

#### 10.2.2 사업 리스트 테이블
- 컨테이너: 다크 그레이, 둥근 모서리 직사각형
- 컬럼 헤더:
  - "사업명" (좌측)
  - "작업" (우측)
- 각 행: 화이트 텍스트로 사업명 표시
- 작업 아이콘:
  - 수정 아이콘: 블루 색상 (연필/펜 아이콘)
  - 삭제 아이콘: 레드 색상 (휴지통 아이콘)
- 버튼 스타일: 기존 디자인과 통일 (라이트 블루 악센트)

### 10.3 LocalStorage 구조
```json
{
  "projectList": ["사업명1", "사업명2", ...],
  "appVersion": "1.0.0"
}
```

### 10.4 키 규칙
- "projectList": 배열
- "appVersion": 마이그레이션용 문자열

### 10.5 버전 업데이트 시 마이그레이션
appVersion 비교 후 구조 변경 발생 시 자동 재설정

### 10.6 세션 관리
- 현재 작업 내용은 저장하지 않음
- 새로고침 시 페이지는 리셋
- "임시 저장(autosave)" 기능은 없음

## 11. 메모리 관리

### 11.1 Blob URL 관리
- 이미지 업로드 시 URL.createObjectURL()로 blob URL 생성
- 이미지 교체 시 이전 blob URL 해제 (URL.revokeObjectURL())
- 이미지 삭제 시 blob URL 해제
- 현재화면 초기화 시 모든 페이지의 모든 blob URL 해제

### 11.2 캔버스 메모리 관리
- html2canvas로 생성된 캔버스는 사용 후 메모리 해제
- 캔버스 width: 0, height: 0 설정으로 메모리 해제

### 11.3 출력 시 리소스 정리
- 출력 완료 후 임시 DOM 컨테이너 제거
- 모든 React Root 언마운트
- 생성된 모든 리소스가 안전하게 정리됨

## 12. 에러 처리 및 제약사항

### 12.1 에러 시나리오
- 이미지 로드 실패 → "이미지를 불러올 수 없습니다" 안내
- 용량 초과 → "파일 크기 제한 초과(15MB)" 메시지
- 출력 실패 → "PDF 생성 중 오류 발생" 팝업
- LocalStorage 용량 초과 → "저장 공간 부족" 메시지
- 디렉토리 선택 실패 → "디렉토리 선택에 실패했습니다" 메시지

### 12.2 브라우저 지원
- Chrome (최신) - File System Access API 지원
- Edge (최신) - File System Access API 지원
- Firefox (최신) - 제한적 지원 (출력 경로 지정 불가)
- Safari - 제한적 지원 (출력 경로 지정 불가)

### 12.3 작업 제약
- 동시 생성 가능한 페이지 수: 최대 10페이지
- 이미지 슬롯 개수: 템플릿별 제한 준수
- custom 슬롯 최대 16개

## 13. 성능 및 최적화

### 13.1 대용량 이미지 처리 전략
- html2canvas scale 적용:
  - 일반 출력: scale=2.5
  - 고화질 출력: scale=3.5

### 13.2 로딩 성능
- 이미지 blob 처리
- Lazy loading (필요 시)

### 13.3 모바일 대응
- 모바일에서는 편집 기능 축소형 제공 (향후 구현)

## 14. 디자인 가이드라인 (Tech Startup Neoblue)

### 14.1 전체 테마
전체 분위기:
- 빠르고 스마트한 "사진 문서 자동화 서비스" 느낌
- 세련되고 차별화된 미래 지향적(SaaS / Tech Startup) 분위기
- 다크한 배경 위에 네온 블루 계열 포인트, 글로우 효과를 활용

#### 14.1.1 컬러 스킴 (Tech Startup Neoblue)
- Primary Neoblue (주요 CTA / 강조): #4C6FFF
- Deep Blue (메인 배경 / 카드 베이스): #10131A
- Soft Blue (은은한 테두리 / 구분선 / 서브 포커스): #A8B7F5
- Accent Mint (아이콘 / 하이라이트 / 포커스): #AEEAFF

기본 텍스트:
- 메인 텍스트: 화이트 #FFFFFF
- 서브 텍스트: 연한 그레이-블루 #A0A8C2

원칙:
- 배경은 항상 Deep Blue 계열로 통일
- 인터랙션/CTA는 Neoblue + Mint로 강조
- 구분선/테두리는 Soft Blue를 활용

#### 14.1.2 타이포그래피
폰트 패밀리:
- 국문: SUIT (또는 유사 둥근 Sans-serif)
- 영문: Inter

스타일:
- 헤드라인: Bold, 약간 넓은 자간, 부드러운 둥근 느낌
- 본문/서브 텍스트: Regular~Medium, 가독성 우선

### 14.2 Home 화면 디자인
#### 14.2.1 헤더 & 로고
헤더 배경: Deep Blue #10131A

로고 "JH Pics":
- 색상: Accent Mint #AEEAFF
- 주변에 부드러운 글로우(네온 효과) 적용
- hover 시: scale(1.05~1.08), 글로우 강도 증가, 약간 위로 이동

메뉴 항목 (Home / 사진편집 / 사업리스트):
- 기본 색: Soft Blue ~ 화이트 조합
- 현재 활성 메뉴: 배경에 Neoblue #4C6FFF 반투명 태블릿 형태, 텍스트 화이트
- hover 시: 배경 Neoblue 농도 증가, scale 1.03~1.05

#### 14.2.2 히어로 섹션 (Hero Section)
배경:
- 전체 배경: Deep Blue #10131A
- 중앙에 기하학적 원형/오비탈 패턴을 은은한 Soft Blue/Neoblue로 배치

메인 문구(영문):
- 1줄: "Manage your photos" – 화이트 텍스트
- 2줄: "more efficiently" – Neoblue → Mint 그라데이션 텍스트
- 두 줄 모두 중앙 정렬, 줄바꿈 위치 고정
- 폰트: Inter Bold, 데스크톱 기준 큰 헤드라인 크기

서브 문구(한글):
- "효율적인 사진 작업으로 행정 업무를 더욱 스마트하게"
- 컬러: 서브 텍스트 색 #A0A8C2
- 메인 문구 바로 아래, 중앙 정렬

#### 14.2.3 템플릿 선택 섹션
섹션 제목:
- 텍스트: "템플릿 선택"
- 컬러: White
- 폰트: SUIT Bold, 중앙 정렬

서브 타이틀:
- 텍스트: "원하는 레이아웃과 방향을 선택하여 시작하세요"
- 컬러: #A0A8C2
- 폰트: SUIT Regular, 중앙 정렬

#### 14.2.4 템플릿 카드 디자인 (4/6/커스텀/커스텀2)
카드 공통 스타일:
- 배경: Deep Blue #10131A
- 테두리: 1px Soft Blue #A8B7F5
- 모서리: border-radius 12~16px
- 내부 패딩: 상하좌우 24~32px
- 그림자: 기본은 약한 soft shadow, hover 시 네오블루 글로우 강화

카드 내용 구성 (4컷/6컷/커스텀):
- 상단: 큰 숫자/기호 (4, 6, ◳)
  - 컬러: Primary Neoblue #4C6FFF
  - 폰트: Inter Bold, 크게
- 중간: "Type 4컷" / "Type 6컷" / "Type 커스텀"
  - 컬러: White
  - 폰트: SUIT Medium
- 하단: 버튼 2개 – 세로형 / 가로형
  - pill 형태, 둥근 모서리
  - 기본 상태: 투명 배경, Soft Blue 테두리, White 텍스트
  - hover 시: Neoblue 그라데이션 배경, White 텍스트, 살짝 글로우

카드 hover 효과 (4컷/6컷/커스텀):
- scale: 1.05~1.07
- 테두리 색: Neoblue #4C6FFF로 조금 더 밝게
- box-shadow: Neoblue + Mint 글로우 (0 0 25px rgba(76,111,255,0.6) 등)
- transition: 0.25s ease-out

커스텀2 카드 특별 디자인:
- 상단: 큰 기호 (⧉)
  - 컬러: Accent Mint #AEEAFF
  - 폰트: Inter Bold, 크게
- 중간: "커스텀 사진원본비율"
  - 컬러: White
  - 폰트: SUIT Medium
- 테두리: Accent Mint #AEEAFF
- 하단: 버튼 2개 – 세로형 / 가로형
  - pill 형태, 둥근 모서리
  - 기본 상태: 투명 배경, Accent Mint 테두리 (#AEEAFF), White 텍스트
  - hover 시: Accent Mint 그라데이션 배경 (#AEEAFF → #8DD5FF), White 텍스트, 살짝 글로우

커스텀2 카드 hover 효과:
- scale: 1.05~1.07
- 테두리 색: Accent Mint #AEEAFF 유지
- box-shadow: Accent Mint 글로우 (0 0 25px rgba(174,234,255,0.6))
- transition: 0.25s ease-out

### 14.3 사진편집 화면 디자인
Home 화면의 템플릿 카드 섹션과 완전히 동일한 스타일 사용

전체 배경: Deep Blue #10131A

상단 입력 영역:
- 배경: Deep Blue
- 테두리: Soft Blue
- 입력 필드: Deep Blue 배경, Soft Blue 테두리, White 텍스트
- 포커스 시: Neoblue 테두리

페이지 네비게이션:
- 배경: Deep Blue
- 테두리: Soft Blue
- 현재 페이지 버튼: Neoblue 배경, White 텍스트
- 일반 페이지 버튼: Soft Blue/20 배경, Soft Blue 텍스트

A4Canvas 영역:
- 배경: Deep Blue
- 캔버스: 흰색 배경, 검정 테두리

우측 사이드바:
- 출력 옵션 영역: Deep Blue 배경, Soft Blue 테두리
- 작업 관리 영역: Deep Blue 배경, Soft Blue 테두리
- 버튼: Neoblue 배경, White 텍스트
- 초기화 버튼: Red 배경, White 텍스트

### 14.4 사업리스트 화면 디자인
페이지 배경: Deep Blue #10131A 유지

페이지 헤더:
- "사업 리스트" – White, SUIT Bold
- 우측 상단에 + 사업 추가 버튼
- 배경: Primary Neoblue #4C6FFF
- 텍스트: White
- hover 시: 살짝 더 밝은 파랑 + 글로우

리스트 컨테이너:
- 배경: Deep Blue에 약간 더 밝은 레벨 또는 다크 그레이 블록
- 테두리: Soft Blue #A8B7F5
- 모서리: 12px
- 내부에 테이블 형태로 사업명 / 작업 아이콘 배치

아이콘/버튼:
- 수정 아이콘: Neoblue
- 삭제 아이콘: 레드 계열 (예: #EF4444)
- hover 시 scale 1.1, 색상 살짝 강조

### 14.5 인터랙션 및 애니메이션 원칙
로고 hover:
- scale(1.05~1.08)
- Mint 글로우 강도 증가
- 0.2~0.3s ease-in-out

헤더 메뉴 hover:
- 배경: Neoblue 반투명 → 불투명으로 변화
- scale(1.02~1.05)
- 텍스트 밝기 증가

카드 hover:
- scale(1.05~1.07)
- Neoblue + Mint 글로우
- 테두리 색 강조
- transition: 0.2~0.3s ease-out

버튼 hover:
- 배경 색 조금 더 밝게
- 미세한 scale(1.03~1.05)
- 그림자/글로우 소폭 증가

애니메이션 공통 규칙:
- 과하지 않게, 부드럽고 자연스럽게
- duration: 0.15~0.3초
- easing: ease-out 또는 ease-in-out
- 크기 변화는 10~15% 이내, 위치 이동은 5px 이내

## 15. 기술 스택

### 15.1 프런트엔드
- React 18
- TypeScript
- Vite (빌드 도구)
- Zustand (상태 관리)
- Tailwind CSS (스타일링)
- React Router (라우팅)
- 웹폰트: Google Fonts, jsDelivr CDN (SUIT, Inter, Noto Sans KR, Pretendard, Nanum Gothic, Nanum Myeongjo, IBM Plex Sans KR)

### 15.2 출력 관련
- html2canvas (DOM 캡처)
- jsPDF (PDF 생성)
- File System Access API (출력 경로 지정)

### 15.3 저장소
- LocalStorage (사업리스트 저장)
- IndexedDB (출력 경로 핸들 저장)

### 15.4 배포
- Vercel
- 정적 프런트엔드 배포
- GitHub 연동 → 자동 빌드/자동 배포

## 16. 구현 완료 기능 요약

### 16.1 핵심 기능
✅ 템플릿 선택 (4컷, 6컷, 커스텀, 커스텀2 × 세로형/가로형)
✅ 페이지 관리 (최대 10페이지, 추가/삭제, 메타데이터 복사)
✅ 이미지 업로드 (드래그 앤 드롭, 파일 선택)
✅ 이미지 편집 (확대/축소, 회전, 비율 유지 모드)
✅ 설명 텍스트 추가 (슬롯별, 실시간 저장, 즉시 입력 반영)
✅ 다중 페이지 출력 (PDF 통합, JPEG 개별 파일)
✅ 출력 경로 지정 (File System Access API)
✅ 현재화면 초기화
✅ 사업리스트 관리 (LocalStorage)
✅ Custom2 템플릿 (원본비율 cover 모드 강제, 이미지 확정 기능)

### 16.2 출력 기능
✅ 안정적인 다중 페이지 출력 (절충안 3번 구현)
✅ 빈 슬롯 처리 (하얀 배경으로 공간 유지)
✅ UI 요소 제거 (출력 시 편집 UI 자동 숨김)
✅ 메모리 관리 (캔버스 및 blob URL 정리)
✅ 고화질 옵션
✅ 가로형/세로형 템플릿 출력 지원 (PDF orientation 및 크기 자동 조정)
✅ 파일명 직접 지정 저장 기능 (showSaveFilePicker API 사용)

### 16.3 메모리 관리
✅ Blob URL 정리 (이미지 교체/삭제 시)
✅ 캔버스 메모리 해제 (출력 후)
✅ 초기화 시 정리 (모든 blob URL 해제)

### 16.4 디자인
✅ Tech Startup Neoblue 테마
✅ 호버 효과 및 애니메이션
✅ 반응형 레이아웃

## 17. 기대 효과
- 보조 사진의 문서화 시간 단축
- 직관적인 사진 편집 인터페이스
- 안정적인 다중 페이지 출력
- 효율적인 작업 흐름

---

**문서 버전**: ver2
**최종 업데이트**: 2025-01-XX
**작성 기준**: 현재 구현 완료된 기능 반영 (Custom2 템플릿 포함)

## 18. 최근 개선 사항 (2025-01-XX)

### 18.1 가로형 템플릿 출력 안정성 개선
- 가로형 2컷 템플릿 출력 시 PDF orientation 및 크기 자동 조정
- 가로형: landscape (297mm × 210mm), 세로형: portrait (210mm × 297mm)
- 사진편집 화면과 동일한 레이아웃으로 출력 (페이지 마진 20mm 유지)

### 18.2 내용추가 기능 안정성 개선
- 텍스트 입력란 표시/숨김 로직 개선
- 텍스트가 없을 때는 화면에 보이지 않음 (height: 0, visibility: hidden)
- "내용추가" 버튼 클릭 시 즉시 표시 및 자동 포커스
- blur 시 내용이 없으면 자동으로 숨김 처리

### 18.3 텍스트 입력 반응성 개선
- 로컬 state를 사용하여 타이핑 시 즉시 화면에 반영
- debounce 시간 300ms → 100ms로 단축
- 일반적인 텍스트 입력과 동일한 자연스러운 입력 경험 제공

### 18.4 제목 스타일 옵션 기능 추가 및 개선
- 제목 줄에만 적용되는 스타일 옵션 추가
- 정렬 방식: 왼쪽/가운데/오른쪽 (아이콘 버튼 3개)
- 글꼴 선택: 총 20개 폰트 제공
  - 웹폰트 7개: SUIT, Inter, Noto Sans KR, Pretendard, Nanum Gothic, Nanum Myeongjo, IBM Plex Sans KR (CDN 로드)
  - Windows 기본 글꼴 13개: Malgun Gothic, New Mingjo, Gulim, Human Myeongjo, Gungsuh, Dotum, HY MyeongJo, HY Headline M, Segoe UI, Arial, Tahoma, Courier New, Times New Roman
  - Select 박스에서 각 폰트가 해당 font-family로 미리보기 스타일 적용
- 글꼴 크기: 8~72px (기본값: 19px)
- 진하게: Checkbox 옵션
- 보조사업자/담당자 줄은 항상 왼쪽 정렬로 고정
- 각 페이지별로 독립적으로 제목 스타일 관리
- PDF/JPEG 출력 시에도 동일한 스타일 적용
- 폰트 fallback 처리: 선택된 폰트 + 'Malgun Gothic' + sans-serif
- html2canvas의 onclone 단계에서 폰트 스타일 정확히 복사하여 웹폰트 깨짐 방지
- PDF/JPEG 내보내기 시 폰트 검사 로그 출력 (선택된 폰트명, 적용된 font-family, 웹폰트 로드 여부, fallback 적용 여부)

### 18.5 파일명 지정 저장 기능 개선
- 폴더 선택 방식에서 "다른 이름으로 저장하기" 방식으로 변경
- `window.showSaveFilePicker()` API 사용으로 파일명 직접 지정 가능
- 기본 파일명 자동 생성 (프로젝트 제목 기반)
- 파일명 형식: "제목"("사업명")_"보조사업자" (사업명은 괄호로 표시)
- PDF/JPEG 확장자 선택 가능
- 저장 완료 메시지 및 상세 로그 출력
- 브라우저 미지원 시 자동으로 다운로드 방식으로 대체

### 18.6 템플릿별 설명 텍스트 출력 처리 개선
- 커스텀 템플릿과 일반 템플릿(2/4/6컷)의 설명 텍스트 출력 처리 구분
- 커스텀 템플릿: textarea를 div로 변환하여 고정 높이(21px)로 출력
- 일반 템플릿: textarea를 div로 변환하여 고정 높이(32px)로 출력
- 각 템플릿에 맞는 폰트 크기 및 높이 자동 적용
- 출력 시 텍스트가 실제 노드로 렌더링되어 html2canvas에서 정확히 캡처됨

### 18.7 커스텀 템플릿 텍스트 영역 보호 기능 개선
- 세로형 커스텀 템플릿에서 특정 행 수 조건에서 텍스트 영역이 잘리지 않도록 보정 로직 추가
  - 4행(슬롯 10-12개): 슬롯 최소 높이 130px 적용
  - 5행(슬롯 13-15개): 슬롯 최소 높이 130px 적용
- 가로형 커스텀 템플릿에서 특정 행 수 조건에서 텍스트 영역이 잘리지 않도록 보정 로직 추가
  - 3행(슬롯 7-12개): 슬롯 최소 높이 130px 적용
  - 4행(슬롯 13-16개): 슬롯 최소 높이 130px 적용
- 편집 화면과 출력(PDF/JPEG) 모두에서 텍스트 내용이 정상적으로 표시되고 하단이 잘리지 않음
- 레이아웃 컴포넌트(CustomPortraitLayout, CustomLandscapeLayout)에서 조건부 보정 적용
- exportUtils의 onclone 단계에서 추가 보정 로직으로 출력 시 텍스트 영역 높이 보장
- 문제가 발생하는 구간에서만 보정이 적용되며, 기존에 정상 작동하던 구간(세로형 1-3행, 가로형 1-2행)은 영향 없음

### 18.8 Custom2 템플릿 추가 (커스텀2 – 원본비율)
- **새로운 템플릿 추가**
  - Custom2OriginalRatioPortrait (커스텀2 – 원본비율 세로형)
  - Custom2OriginalRatioLandscape (커스텀2 – 원본비율 가로형)
  - 기존 커스텀 템플릿과 동일한 UI/슬롯 구조/동작 방식 유지
  - 페이지 추가/삭제, 슬롯 추가/삭제, 이미지 업로드/드래그, 텍스트 입력 등 모든 공통 기능은 기존 커스텀과 동일
- **이미지 처리 방식**
  - 항상 `object-fit: cover` 모드로 강제 적용 (원본 비율 유지, 슬롯 완전히 채움)
  - CSS `object-fit: cover` 사용 (JS transform 기반 scale/translate cover 구현 아님)
  - 이미지 업로드 순간부터 cover 모드가 기본값으로 자동 적용
  - "비율유지" 버튼(cover/fill 토글)은 UI/기능 둘 다 존재하지 않음
  - 어떤 경우에도 fill 기반 계산으로 되돌아가지 않음
- **데이터 구조 확장**
  - `ImageSlot` 인터페이스에 `croppedImageUrl?: string` 필드 추가
    - Custom2에서 "이미지 확정" 버튼 클릭 시 자동 크롭된 이미지의 Data URL 저장
    - 크롭된 이미지는 슬롯 크기에 딱 맞게 잘라낸 비트맵 데이터
  - `ImageSlot` 인터페이스에 `isConfirmed?: boolean` 필드 추가
    - "이미지 확정" 버튼을 통해 확정되었는지 여부를 나타내는 플래그
  - `isCustom2Template()` 헬퍼 함수 추가 (`ui/src/utils/typeGuards.ts`)
    - 템플릿 타입이 Custom2인지 확인하는 유틸리티 함수
    - `templateType === 'custom2-portrait' || templateType === 'custom2-landscape'` 조건으로 판별
- **이미지 확정 기능 (자동 크롭)**
  - 출력 옵션 영역에 "이미지 확정" 버튼 제공 (Custom2 템플릿에서만 표시)
  - 버튼 클릭 시 `handleConfirmImagesForCustom2()` 함수 실행
  - 자동 크롭 로직:
    1. 현재 페이지의 모든 슬롯을 순회
    2. 이미지가 있는 슬롯에 대해서만 처리 (`!!slot.imageUrl || !!slot.imageFile`)
    3. DOM에서 실제 이미지 요소 찾기 (`img[data-slot-id="${slot.id}"]`)
    4. 이미지 컨테이너의 실제 크기 측정 (`getBoundingClientRect()`)
    5. 원본 이미지 로드 (naturalWidth/naturalHeight 사용)
    6. Cover 모드 기준으로 크롭 영역 계산:
       - 슬롯 크기 × exportScale(3배)로 캔버스 크기 설정
       - `Math.max(canvasWidth / naturalWidth, canvasHeight / naturalHeight)` 로 cover scale 계산
       - 중앙 정렬을 위한 offset 계산
    7. Canvas API를 사용하여 오프스크린에서 크롭:
       - 회전 및 스케일 변환 적용 (현재 편집 상태 반영)
       - `canvas.toDataURL('image/jpeg', 0.9)` 로 Data URL 생성
    8. 각 슬롯에 `croppedImageUrl` 및 `isConfirmed: true` 저장
  - 확정 완료 시 "이미지 확정이 완료되었습니다." 토스트 메시지 표시
- **렌더링 우선순위**
  - Custom2 템플릿의 `ImageSlot` 컴포넌트에서 `croppedImageUrl ?? imageUrl` 우선순위로 이미지 표시
  - "이미지 확정" 전: `imageUrl` 사용 (기존 cover 미리보기, transform 적용)
  - "이미지 확정" 후: `croppedImageUrl` 사용 (실제 크롭된 비트맵, transform 미적용)
  - 크롭된 이미지는 이미 편집 상태가 적용된 상태이므로 CSS transform(scale, rotation) 적용하지 않음
  - Custom2 레이아웃 컴포넌트에서 `slot.croppedImageUrl` prop을 `ImageSlot`에 전달
- **출력 전 필수 검사**
  - Custom2 템플릿에서 PDF/JPEG 출력 시도 시, 이미지가 있는 슬롯 중 확정되지 않은 슬롯이 있으면 경고 메시지 표시
  - 검사 로직:
    - `handleExportPDF()` 및 `handleExportJPEG()` 함수 시작 부분에 검사 추가
    - 모든 페이지를 순회하며 Custom2 템플릿인지 확인
    - Custom2 템플릿인 경우, 각 슬롯에 대해 `hasImage && (!isConfirmed || !croppedImageUrl)` 조건 확인
    - 조건을 만족하는 슬롯이 하나라도 있으면 검사 실패
  - 검사 실패 시:
    - `alert()` 함수로 경고 메시지 표시: "커스텀2 템플릿에서는 출력 전에 반드시 '이미지 확정' 버튼을 눌러주세요."
    - 출력 프로세스 즉시 중단 (`return` 처리)
  - 검사 통과 시:
    - 모든 슬롯이 확정된 경우(`isConfirmed: true` 및 `croppedImageUrl` 존재)에만 출력 진행
    - 출력 시 `croppedImageUrl`이 있으면 해당 이미지를 사용하여 출력
- **홈화면 카드 추가 및 디자인**
  - "커스텀2" 카드 추가 (기호: "⧉")
  - 카드 문구: "커스텀 사진원본비율" (White 색상)
  - 커스텀2 카드 전용 디자인:
    - 기호 색상: Accent Mint #AEEAFF
    - 카드 테두리: Accent Mint #AEEAFF
    - Hover 시 glow 효과: Accent Mint 계열 (rgba(174,234,255,0.6))
    - 버튼 hover 효과: Accent Mint 그라데이션 (#AEEAFF → #8DD5FF)
- **템플릿 카드 변경사항**
  - 2컷 템플릿 카드 제거 (홈 화면 및 사진편집 페이지)
  - 커스텀 템플릿 카드 기호 변경: "∞" → "◳"

### 18.9 템플릿 카드 UI 개선 (2025-01-XX)
- **2컷 템플릿 카드 제거**
  - 홈 화면과 사진편집 페이지에서 2컷 템플릿 카드 완전 제거
  - 현재 표시되는 템플릿: 4컷, 6컷, 커스텀, 커스텀2
- **커스텀 템플릿 카드 기호 변경**
  - 기존 기호 "∞" → 새로운 기호 "◳"로 변경
  - 홈 화면과 사진편집 페이지에 동일하게 적용
- **커스텀2 템플릿 카드 디자인 개선**
  - 기호 변경: "Ⅱ" → "⧉" (로마 숫자에서 특수 기호로 변경)
  - 색상 통일: Accent Mint #AEEAFF 계열로 통일
    - 기호 색상: #AEEAFF
    - 카드 테두리: #AEEAFF
    - Hover glow 효과: rgba(174,234,255,0.6)
  - 텍스트 색상: "커스텀 사진원본비율" 문구는 White로 표시
  - 버튼 hover 효과: Accent Mint 그라데이션 (#AEEAFF → #8DD5FF)
  - 기존 hover 효과(scale, transition) 유지

### 18.10 템플릿별 비율유지 버튼 제거 (2025-01-XX)
- **4컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼 완전 제거
  - 사진 편집 화면에서 이미지에 마우스를 올려도 "비율유지" 버튼이 표시되지 않음
  - UI 및 기능 모두 제거됨
- **6컷 템플릿 (가로형, 세로형)**: "비율유지" 버튼 완전 제거
  - 사진 편집 화면에서 이미지에 마우스를 올려도 "비율유지" 버튼이 표시되지 않음
  - UI 및 기능 모두 제거됨
- **커스텀1 템플릿 (가로형, 세로형)**: "비율유지" 버튼 완전 제거
  - 사진 편집 화면에서 이미지에 마우스를 올려도 "비율유지" 버튼이 표시되지 않음
  - UI 및 기능 모두 제거됨
- **2컷 템플릿**: 기존 동작 유지 (비율유지 버튼 표시)
- **커스텀2 템플릿**: 기존 동작 유지 (비율유지 버튼 없음, cover 모드 강제)

